# Ассемблерные директивы и типы данных

## 1. Ассемблерные директивы

Директивы управляют процессом компиляции и компоновки, но не генерируют машинный код.

### 1.1 Директивы сегментации (области памяти)

Задают кодовые, данные и стековые сегменты в 16- и 32-битном режиме.

| Директива  | Описание                                                 |
|------------|----------------------------------------------------------|
| `.section` | Определяет секцию ELF-файла (например, `.section .data`) |
| `.text`    | Обозначает сегмент кода (исполняемые инструкции)         |
| `.data`    | Обозначает сегмент инициализированных данных             |
| `.bss`     | Обозначает сегмент неинициализированных данных           |
| `.rodata`  | Секция только для чтения (например, строковые литералы)  |

### 1.2 Директивы данных

Используются для объявления переменных и констант.

| Директива | Описание                                          |
|-----------|---------------------------------------------------|
| `.byte`   | Определяет 8-битное значение (1 байт)             |
| `.word`   | Определяет 16-битное значение (2 байта)           |
| `.long`   | Определяет 32-битное значение (4 байта)           |
| `.quad`   | Определяет 64-битное значение (8 байт)            |
| `.float`  | Определяет 32-битное число с плавающей точкой     |
| `.double` | Определяет 64-битное число с плавающей точкой     |
| `.ascii`  | Строка без завершающего \0                        |
| `.asciz`  | Строка с завершающим нулем (\0)                   |
| `.equ`    | Определяет константу (например, `PI .equ 3.1415`) |

### 1.3 Директивы выделения памяти

Используются для резервирования памяти.

| Директива                 | Описание                                  |
|---------------------------|-------------------------------------------|
| `.zero n`                 | Выделяет n байт, заполненных нулями       |
| `.comm name, size, align` | Определяет глобальный символ (переменную) |
| `.lcomm name, size`       | Определяет локальный символ (переменную)  |

### 1.4 Директивы контроля кода

Управляют исполнением программы.

| Директива         | Описание                                                     |
|-------------------|--------------------------------------------------------------|
| `.global`         | Делает символ (метку, переменную) видимой за пределами файла |
| `.extern`         | Объявляет внешний символ (из другого файла)                  |
| `.align n`        | Выравнивание к n байтам                                      |
| `.org`            | Изменяет текущий адрес размещения                            |
| `.include "file"` | Включает другой файл в код                                   |

### 1.5 Макросы и условия

Помогают структурировать код.

| Директива                | Описание                    |
|--------------------------|-----------------------------|
| `.macro name [args]`     | Определяет макрос           |
| `.endm`                  | Завершает макрос            |
| `.if`, `.else`, `.endif` | Условные директивы          |
| `.rept n`                | Повторяет код n раз         |
| `.irp param, values`     | Итерация по списку значений |
| `.irpc param, "string"`  | Итерация по символам строки |

## 2. Типы данных

В x86 Assembly типы данных основаны на размере, а не на семантике.

### 2.1 Целочисленные типы

| Тип   | Размер (бит)  | Директива |
|-------|---------------|-----------|
| byte  | 8             | `.byte`   |
| word  | 16            | `.word`   |
| dword | 32            | `.long`   |
| qword | 64            | `.quad`   |

### 2.2 Числа с плавающей точкой (IEEE 754)

| Тип    | Размер (бит) | Директива |
|--------|-------------|------------|
| float  | 32          | `.float`   |
| double | 64          | `.double`  | 

### 2.3 Строки

| Тип      | Описание              |
|----------|-----------------------|
| `.ascii` | Создаёт строку без \0 |
| `.asciz` | Создаёт строку с \0   |

### 2.4 Другие

| Тип    | Описание                                      |
|--------|-----------------------------------------------|
| `void` | Неопределённый тип (для nop и ret)            |
| `ptr`  | Указатели, используются в косвенной адресации |

## 3. Директивы определения данных в NASM

### 3.1 Инициализированные данные (определение с начальным значением)

В NASM используются следующие директивы для определения инициализированных данных:

| Директива | Размер     | Описание                                  | Пример использования          |
|-----------|------------|-------------------------------------------|-------------------------------|
| `db`      | 1 байт     | Define Byte - определяет 8-битные данные  | `var1 db 10, 'A', 0x42`       |
| `dw`      | 2 байта    | Define Word - 16-битные данные            | `count dw 1000`               |
| `dd`      | 4 байта    | Define Doubleword - 32-битные данные      | `array dd 1, 2, 3, 4`         |
| `dq`      | 8 байт     | Define Quadword - 64-битные данные        | `bignum dq 123456789012345`   |
| `dt`      | 10 байт    | Define Ten bytes - 80-битные данные (FPU) | `flt_val dt 3.14159`          |

### 3.2 Неинициализированные данные (резервирование памяти)

Директивы для резервирования блоков неинициализированных данных (обычно используются в секции `.bss`):

| Директива | Размер     | Описание                                   | Пример использования      |
|-----------|------------|--------------------------------------------|---------------------------|
| `resb`    | 1 байт     | Reserve Byte - резервирует 8-битные данные | `buffer resb 64`          |
| `resw`    | 2 байта    | Reserve Word - 16-битные данные            | `array resw 10`           |
| `resd`    | 4 байта    | Reserve Doubleword - 32-битные данные      | `integers resd 100`       |
| `resq`    | 8 байт     | Reserve Quadword - 64-битные данные        | `large_val resq 2`        |
| `rest`    | 10 байт    | Reserve Ten bytes - 80-битные данные       | `flt_vals rest 5`         |

### 3.3 Примеры использования

```asm
section .data   ; Секция инициализированных данных
    msg db "Hello, World!", 0   ; Строка с нулевым окончанием
    value dd 42                 ; 32-битное целое число
    matrix dd 1.0, 2.0, 3.0, 4.0 ; Массив из 4 чисел типа float

section .bss    ; Секция неинициализированных данных
    buffer resb 256             ; Буфер размером 256 байт
    array resd 100              ; Массив из 100 элементов по 4 байта каждый
    bigbuffer resq 1024         ; Большой буфер из 8-байтовых элементов
```

### 3.4 Множественное повторение

Для определения массивов или блоков данных можно использовать модификатор `times`:

```nasm
zeros times 100 db 0      ; Создать 100 байт со значением 0
table times 10 dw 3000    ; Создать массив из 10 элементов типа word, каждый со значением 3000
empty times 64 resb 1     ; Резервировать 64 байта в секции .bss
